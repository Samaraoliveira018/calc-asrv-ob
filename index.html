<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulador Soros 2 Níveis</title>

<style>
body{
    font-family: Arial, sans-serif;
    background:#f4f6f9;
    padding:20px;
}

.container{
    max-width:1100px;
    margin:auto;
    background:#fff;
    padding:20px;
    border-radius:10px;
    box-shadow:0 4px 10px rgba(0,0,0,0.1);
}

h1{
    text-align:center;
}

input{
    padding:8px;
    margin:5px;
    width:150px;
}

button{
    padding:10px 15px;
    margin-top:10px;
    cursor:pointer;
    border:none;
    border-radius:5px;
    background:#2e7d32;
    color:#fff;
}

table{
    width:100%;
    border-collapse:collapse;
    margin-top:20px;
}

th{
    background:#2e3d4f;
    color:#fff;
    padding:10px;
}

td{
    padding:8px;
    text-align:center;
    border-bottom:1px solid #ddd;
}

.currency{
    color:#2e7d32;
    font-weight:bold;
}
</style>
</head>

<body>

<div class="container">

<h1>Simulador Soros 2 Níveis</h1>

<div>
    <label>Banca Inicial:</label>
    <input type="number" id="bancaInicial" value="450">

    <label>% Investido:</label>
    <input type="number" id="investimentoPercentual" value="5">

    <label>Payout %:</label>
    <input type="number" id="payoutPercentual" value="88">

    <label>Dias:</label>
    <input type="number" id="diasPlanejamento" value="10">

    <br>
    <button onclick="calcularDados()">Calcular</button>
    <button onclick="gerarCSV()">Exportar CSV</button>
</div>

<table>
<thead>
<tr>
<th>Dia</th>
<th>Banca Inicial</th>
<th>%</th>
<th>1ª Entrada</th>
<th>Lucro 1ª</th>
<th>Entrada Soros</th>
<th>Lucro 2ª</th>
<th>Lucro Total</th>
<th>Nova Banca</th>
</tr>
</thead>
<tbody id="tabelaBody">
</tbody>
</table>

</div>

<script>

let dadosCalculados = [];

function calcularDados(){

    const bancaInicial = parseFloat(document.getElementById('bancaInicial').value);
    const investimentoPercentual = parseFloat(document.getElementById('investimentoPercentual').value);
    const payoutPercentual = parseFloat(document.getElementById('payoutPercentual').value);
    const dias = parseInt(document.getElementById('diasPlanejamento').value);

    dadosCalculados = [];
    let bancaAtual = bancaInicial;

    for(let dia=1; dia<=dias; dia++){

        const primeiraEntrada = bancaAtual * (investimentoPercentual/100);
        const lucroPrimeira = primeiraEntrada * (payoutPercentual/100);

        const entradaSoros = primeiraEntrada + lucroPrimeira;
        const lucroSegunda = entradaSoros * (payoutPercentual/100);

        const lucroTotalDia = lucroPrimeira + lucroSegunda;

        const novaBanca = bancaAtual + lucroTotalDia;

        dadosCalculados.push({
            dia,
            bancaInicial: bancaAtual,
            investimentoPercentual,
            primeiraEntrada,
            lucroPrimeira,
            entradaSoros,
            lucroSegunda,
            lucroTotalDia,
            novaBanca
        });

        bancaAtual = novaBanca;
    }

    atualizarTabela();
}

function atualizarTabela(){

    const tbody = document.getElementById('tabelaBody');
    tbody.innerHTML = '';

    dadosCalculados.forEach(item => {

        const tr = document.createElement('tr');

        tr.innerHTML = `
            <td>${item.dia}</td>
            <td class="currency">R$ ${item.bancaInicial.toFixed(2)}</td>
            <td>${item.investimentoPercentual}%</td>
            <td class="currency">R$ ${item.primeiraEntrada.toFixed(2)}</td>
            <td class="currency">R$ ${item.lucroPrimeira.toFixed(2)}</td>
            <td class="currency">R$ ${item.entradaSoros.toFixed(2)}</td>
            <td class="currency">R$ ${item.lucroSegunda.toFixed(2)}</td>
            <td class="currency">R$ ${item.lucroTotalDia.toFixed(2)}</td>
            <td class="currency">R$ ${item.novaBanca.toFixed(2)}</td>
        `;

        tbody.appendChild(tr);
    });

}

function gerarCSV(){

    if(dadosCalculados.length === 0){
        alert("Calcule primeiro!");
        return;
    }

    let csv = 'Dia,Banca Inicial,% Investido,1ª Entrada,Lucro 1ª,Entrada Soros,Lucro 2ª,Lucro Total,Nova Banca\n';

    dadosCalculados.forEach(item => {
        csv += `${item.dia},${item.bancaInicial.toFixed(2)},${item.investimentoPercentual},${item.primeiraEntrada.toFixed(2)},${item.lucroPrimeira.toFixed(2)},${item.entradaSoros.toFixed(2)},${item.lucroSegunda.toFixed(2)},${item.lucroTotalDia.toFixed(2)},${item.novaBanca.toFixed(2)}\n`;
    });

    const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = "simulador_soros.csv";
    link.click();
}

</script>

</body>
</html>
