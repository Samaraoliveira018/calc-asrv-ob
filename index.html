<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gerenciador de Banca - Simulador</title>
<style>
body{
  font-family:'Segoe UI',sans-serif;
  background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
  color:#333;padding:20px;
}
.container{
  background:#fff;max-width:1100px;margin:auto;padding:25px;
  border-radius:15px;box-shadow:0 10px 30px rgba(0,0,0,.2);
}
h1{text-align:center;color:#2c3e50;}
.config{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:10px;margin:20px 0;}
input{padding:10px;border:2px solid #ddd;border-radius:8px;font-size:1em;}
button{
  border:none;border-radius:6px;cursor:pointer;padding:6px 10px;
  font-size:.9em;font-weight:bold;color:white;
}
button.win{background:#2ecc71;}
button.loss{background:#e74c3c;}
button.win:hover{background:#27ae60;}
button.loss:hover{background:#c0392b;}
table{width:100%;border-collapse:collapse;margin-top:20px;}
th,td{padding:8px;text-align:center;border-bottom:1px solid #ddd;}
th{background:#2c3e50;color:white;position:sticky;top:0;}
.currency{color:#27ae60;font-weight:600;}
tfoot td{background:#f3f9ff;font-weight:bold;}
</style>
</head>
<body>
<div class="container">
<h1>üìä Simulador de Gerenciamento de Banca</h1>

<div class="config">
  <div><label>üí∞ Banca Inicial<br><input id="bancaInicial" type="number" value="400"></label></div>
  <div><label>üí∏ % Investimento Di√°rio<br><input id="investimentoPercentual" type="number" value="10"></label></div>
  <div><label>üíπ Payout (%)<br><input id="payoutPercentual" type="number" value="88"></label></div>
  <div><label>üî¢ Opera√ß√µes por Dia<br><input id="operacoesPorDia" type="number" value="2"></label></div>
  <div><label>üìÖ Dias Planejamento<br><input id="diasPlanejamento" type="number" value="30"></label></div>
</div>

<div>
  <label><input type="radio" name="tipoGerenciamento" value="fixo" checked> M√£o Fixa</label>
  <label><input type="radio" name="tipoGerenciamento" value="soros"> M√£o de Soros</label>
</div>

<table id="tabela">
<thead>
<tr>
<th>Dia</th><th>Banca Inicial</th><th>%</th><th>Entradas</th>
<th>Lucros</th><th>Lucro Di√°rio</th><th>Nova Banca</th><th>Gerenciamento</th><th>A√ß√µes</th>
</tr>
</thead>
<tbody id="linhas"></tbody>
<tfoot id="resumo"></tfoot>
</table>
</div>

<script>
document.addEventListener("DOMContentLoaded",()=>{

let dados=[];

function calcular(){
  const bancaInicial=+bancaInput("bancaInicial");
  const perc=+bancaInput("investimentoPercentual");
  const payout=+bancaInput("payoutPercentual");
  const ops=+bancaInput("operacoesPorDia");
  const dias=+bancaInput("diasPlanejamento");
  const tipo=document.querySelector('input[name="tipoGerenciamento"]:checked').value;

  dados=[];let banca=bancaInicial;
  for(let d=1;d<=dias;d++){
    let entradas=[],lucros=[],lucroDia=0;
    if(tipo==="fixo"){
      const investDia=banca*(perc/100);
      const entrada=investDia/ops;
      for(let i=0;i<ops;i++){
        const l=entrada*(payout/100);
        entradas.push(entrada);
        lucros.push(l);
        lucroDia+=l;
      }
      banca+=lucroDia;
    }else{
      const base=banca*(perc/100);
      for(let i=0;i<ops;i++){
        const entrada=i===0?base:(base+lucros[i-1]);
        const lucro=entrada*(payout/100);
        entradas.push(entrada);
        lucros.push(lucro);
        lucroDia+=lucro;
      }
      banca+=lucroDia;
    }
    dados.push({dia:d,entradas, lucros, lucroDia, tipo, bancaInicial:banca-(lucroDia), bancaFinal:banca});
  }
  render();
}

function render(){
  const tbody=document.getElementById("linhas");
  const tfoot=document.getElementById("resumo");
  tbody.innerHTML="";

  dados.forEach((r,i)=>{
    const entr=r.entradas.map((v,j)=>`${j+1}¬™:R$${v.toFixed(2)}`).join(" ‚Üí ");
    const luc=r.lucros.map((v,j)=>`${j+1}¬™:R$${v.toFixed(2)}`).join(" ‚Üí ");
    tbody.innerHTML+=`
    <tr>
      <td>${r.dia}</td>
      <td class='currency'>R$ ${r.bancaInicial.toFixed(2)}</td>
      <td>${bancaInput("investimentoPercentual")}%</td>
      <td>${entr}</td>
      <td>${luc}</td>
      <td class='currency'>R$ ${r.lucroDia.toFixed(2)}</td>
      <td class='currency'>R$ ${r.bancaFinal.toFixed(2)}</td>
      <td>${r.tipo}</td>
      <td>
        <button class="win" onclick="marcar(${i},'win')">Win</button>
        <button class="loss" onclick="marcar(${i},'loss')">Loss</button>
      </td>
    </tr>`;
  });

  const lucroTotal=dados[dados.length-1].bancaFinal - dados[0].bancaInicial;
  const crescimento=(lucroTotal/dados[0].bancaInicial)*100;
  const lucroMedio=lucroTotal/dados.length;
  tfoot.innerHTML=`<tr><td colspan="9" style="text-align:right">
  üí∞ Lucro Total: R$ ${lucroTotal.toFixed(2)} |
  üìà Crescimento: ${crescimento.toFixed(2)}% |
  üóìÔ∏è Lucro M√©dio/Dia: R$ ${lucroMedio.toFixed(2)}</td></tr>`;
}

window.marcar=function(index,acao){
  // simular resultado manual
  const dia=dados[index];
  let bancaAnt=dados[index].bancaInicial;
  if(acao==='loss'){
    // se loss na primeira -> parar o dia
    const perda=dia.entradas[0];
    dia.lucroDia=-perda;
    dia.bancaFinal=bancaAnt-dia.entradas[0];
    // zera todas seguintes
    for(let i=index+1;i<dados.length;i++){
      dados[i].bancaInicial=dados[i-1].bancaFinal;
      dados[i].bancaFinal=dados[i].bancaInicial; // sem lucro
      dados[i].lucroDia=0;
    }
  }else{
    // win -> recalcula normalmente a partir do dia atual
    calcular();
  }
  render();
}

function bancaInput(id){return document.getElementById(id).value;}

["bancaInicial","investimentoPercentual","payoutPercentual","operacoesPorDia","diasPlanejamento"]
.forEach(id=>document.getElementById(id).addEventListener("input",calcular));
document.querySelectorAll('input[name="tipoGerenciamento"]').forEach(r=>r.addEventListener("change",calcular));

calcular();
});
</script>
</body>
</html>
